{% extends 'base.html.twig' %}

{% block title %}Mes Résultats Quiz
{% endblock %}

{% block body %}
	<div class="container my-5">
		<div class="text-center mb-5">
			<h1 class="main-title display-4 mb-3">
				<i class="fas fa-trophy me-2"></i>Mes Résultats
			</h1>
			<p class="lead text-light">Retrouve toutes tes performances ici</p>
		</div>

		<!-- Statistiques globales -->
		<div class="row g-4 mb-5">
			<div class="col-md-4">
				<div class="stat-card card bg-dark h-100 text-center">
					<div class="card-body">
						<i class="fas fa-play-circle fa-3x text-primary mb-3"></i>
						<h2 class="display-4 mb-0">{{ totalPlays }}</h2>
						<p class="text-light mb-0">Quiz complétés</p>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="stat-card card bg-dark h-100 text-center">
					<div class="card-body">
						<i class="fas fa-star fa-3x text-warning mb-3"></i>
						<h2 class="display-4 mb-0">{{ averageScore }}</h2>
						<p class="text-light mb-0">Score moyen</p>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="stat-card card bg-dark h-100 text-center">
					<div class="card-body">
						<i class="fas fa-medal fa-3x text-success mb-3"></i>
						<h2 class="display-4 mb-0">{{ perfectScores }}</h2>
						<p class="text-light mb-0">Scores parfaits</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Historique des résultats -->
		<div class="card bg-dark shadow-lg">
			<div class="card-header bg-gradient-primary">
				<h4 class="mb-0">
					<i class="fas fa-history me-2"></i>Historique
				</h4>
			</div>
			<div class="card-body">
				{% if results is not empty %}
					<div class="timeline">
						{% for result in results %}
							<div class="timeline-item mb-4">
								<div class="row align-items-center">
									<div class="col-md-3">
										<small class="text-light">
											<i class="fas fa-calendar me-1"></i>
											{{ result.completedAt|date('d/m/Y H:i') }}
										</small>
									</div>
									<div class="col-md-5">
										<h5 class="mb-1">{{ result.quiz.title }}</h5>
										<span class="badge bg-info me-2">{{ result.quiz.theme|capitalize }}</span>
										<span class="badge bg-{{
												                                        result.quiz.difficulty == 'facile' ? 'success' :
												                                        result.quiz.difficulty == 'moyen' ? 'warning' :
												                                        result.quiz.difficulty == 'difficile' ? 'danger' : 'dark'
												                                    }}">
											{{ result.quiz.difficulty|capitalize }}
										</span>
									</div>
									<div class="col-md-2 text-center">
										<div class="score-circle-mini {{ result.percentage >= 80 ? 'score-excellent' : (result.percentage >= 50 ? 'score-good' : 'score-bad') }}">
											<strong>{{ result.score }}</strong>/{{ result.quiz.questions|length }}
										</div>
										<small class="text-light">{{ result.percentage }}%</small>
									</div>
									<div class="col-md-2 text-end">
										<a href="{{ path('quiz_play', {id: result.quiz.id}) }}" class="btn btn-sm btn-outline-primary">
											<i class="fas fa-redo me-1"></i>Rejouer
										</a>
									</div>
								</div>
								{% if not loop.last %}
									<hr class="my-3 border-secondary">
								{% endif %}
							</div>
						{% endfor %}
					</div>
				{% else %}
					<div class="text-center py-5">
						<i class="fas fa-clipboard-list fa-4x text-muted mb-4"></i>
						<h4 class="text-light mb-3">Aucun résultat pour le moment</h4>
						<p class="text-muted mb-4">Commence à jouer pour voir tes résultats ici !</p>
						<a href="{{ path('quiz_index') }}" class="btn btn-primary btn-lg">
							<i class="fas fa-gamepad me-2"></i>Découvrir les quiz
						</a>
					</div>
				{% endif %}
			</div>
		</div>

		<!-- Bouton retour -->
		<div class="text-center mt-4">
			<a href="{{ path('quiz_index') }}" class="btn btn-outline-light">
				<i class="fas fa-arrow-left me-2"></i>Retour aux quiz
			</a>
		</div>
	</div>

	<style>
		.bg-gradient-primary {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		}

		.stat-card {
			transition: all 0.3s ease;
			border: 2px solid rgba(255, 255, 255, 0.1);
		}

		.stat-card:hover {
			transform: translateY(-5px);
			border-color: #667eea;
			box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
		}

		.score-circle-mini {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 60px;
			height: 60px;
			border-radius: 50%;
			font-size: 1.2rem;
			font-weight: bold;
			margin-bottom: 0.5rem;
		}

		.score-excellent {
			background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
			color: white;
		}

		.score-good {
			background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
			color: white;
		}

		.score-bad {
			background: linear-gradient(135deg, #434343 0%, #000000 100%);
			color: white;
		}

		.timeline-item {
			transition: all 0.3s ease;
			padding: 1rem;
			border-radius: 8px;
		}

		.timeline-item:hover {
			background: rgba(102, 126, 234, 0.1);
		}
	</style>
{% endblock %}
